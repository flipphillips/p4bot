services:
  p4bot:
    build: .
    image: local/p4bot:latest
    ports:
      - "8080:8080"
    environment:
      P4_SCRIPT_ROOT: /scripts
      SLACK_COMMAND_MAP: "{}"
      P4PORT: "ssl:mss-perforce-01.rit.edu:1666"
      P4USER: "p4status"
      P4CLIENT: ""

    volumes:
      - ../:/srv/p4bot:cached
      - ./app:/scripts
    restart: unless-stopped
    # Override the image CMD (which starts gunicorn) so the container
    # comes up for interactive/manual testing. Run the server manually
    # inside the container when you're ready (see notes below).
    command: ["/bin/sh", "-c", "tail -f /dev/null"]
